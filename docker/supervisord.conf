[supervisord]
nodaemon=true
user=genesis
logfile=/app/.genesis/logs/supervisord.log
pidfile=/app/.genesis/supervisord.pid
childlogdir=/app/.genesis/logs

[program:genesis]
command=python -m genesis
directory=/app
autostart=true
autorestart=true
startsecs=10
startretries=3
stopwaitsecs=10
stdout_logfile=/app/.genesis/logs/genesis.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5
stderr_logfile=/app/.genesis/logs/genesis_error.log
stderr_logfile_maxbytes=10MB
stderr_logfile_backups=5
environment=PYTHONUNBUFFERED="1"
user=genesis

[program:backup]
command=bash /app/scripts/backup.sh
directory=/app
autostart=false
autorestart=false
startsecs=0
stdout_logfile=/app/.genesis/logs/backup.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=2
stderr_logfile=/app/.genesis/logs/backup_error.log
stderr_logfile_maxbytes=10MB
stderr_logfile_backups=2
user=genesis

[eventlistener:genesis_exit]
command=python /app/scripts/emergency_close.py
events=PROCESS_STATE_FATAL,PROCESS_STATE_EXITED
stdout_logfile=/app/.genesis/logs/emergency.log
stderr_logfile=/app/.genesis/logs/emergency_error.log
user=genesis

[unix_http_server]
file=/app/.genesis/supervisor.sock
chmod=0700
chown=genesis:genesis

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///app/.genesis/supervisor.sock