# Story 1.1: Project Infrastructure Setup

## Status
Ready for Review

## Story
**As a** solo trader,
**I want** a properly configured development and deployment environment,
**so that** I can develop safely and deploy reliably without risking production trading

## Acceptance Criteria
1. Git repository initialized with .gitignore for Python, API keys never committed
2. Python 3.11+ virtual environment with requirements.txt for dependency management
3. Project structure created (/engine, /strategies, /risk, /analytics directories)
4. Configuration management using environment variables with .env.example template
5. Docker container configuration for consistent deployment
6. Basic Makefile with commands for test, run, deploy
7. Pre-commit hooks for code formatting (black) and linting (pylint)
8. README with setup instructions and architecture overview

## Tasks / Subtasks
- [x] Initialize Git repository and configure source control (AC: 1)
  - [x] Create .gitignore with Python template entries
  - [x] Add specific ignores for .env files, API keys, secrets
  - [x] Add ignores for .genesis/ runtime data directory
  - [x] Initialize git repository with initial commit
- [x] Set up Python development environment (AC: 2)
  - [x] Create virtual environment using Python 3.11.8
  - [x] Create requirements/ directory structure
  - [x] Create base.txt with core dependencies from tech stack
  - [x] Create sniper.txt that references base.txt
  - [x] Create dev.txt with testing and development tools
  - [x] Generate initial requirements.txt from base requirements
- [x] Create project directory structure (AC: 3)
  - [x] Create main genesis/ package directory
  - [x] Create genesis/core/, genesis/engine/, genesis/strategies/, genesis/risk/ subdirectories  
  - [x] Create genesis/analytics/, genesis/exchange/, genesis/data/, genesis/ui/, genesis/utils/ subdirectories
  - [x] Create tests/ directory with unit/ and integration/ subdirs
  - [x] Create scripts/, docker/, docs/ directories
  - [x] Create alembic/ directory for migrations
  - [x] Create config/ directory for configuration files
  - [x] Add __init__.py files to all Python packages
- [x] Implement configuration management (AC: 4)
  - [x] Create .env.example template with all required variables
  - [x] Create config/settings.py using Pydantic for validation
  - [x] Add environment variable parsing with defaults
  - [x] Add configuration validation on startup
  - [x] Document all environment variables in .env.example
- [x] Set up Docker configuration (AC: 5)
  - [x] Create Dockerfile with Python 3.11.8 base image
  - [x] Create docker-compose.yml for local development
  - [x] Create docker-compose.prod.yml for production
  - [x] Add volume mounts for data persistence
  - [x] Configure container restart policies
- [x] Create Makefile with common commands (AC: 6)
  - [x] Add 'make install' for dependency installation
  - [x] Add 'make test' for running pytest
  - [x] Add 'make run' for starting application
  - [x] Add 'make deploy' for deployment process
  - [x] Add 'make format' for black formatting
  - [x] Add 'make lint' for ruff linting
  - [x] Add 'make backup' for backup script
- [x] Configure pre-commit hooks (AC: 7)
  - [x] Install pre-commit framework
  - [x] Configure black formatter with line length 88
  - [x] Configure ruff linter instead of pylint (as per tech stack)
  - [x] Add mypy for type checking
  - [x] Create .pre-commit-config.yaml
  - [x] Test hooks with sample commit
- [x] Create README documentation (AC: 8)
  - [x] Write project overview and purpose
  - [x] Add setup instructions for development
  - [x] Include architecture overview diagram reference
  - [x] Add quick start guide
  - [x] Document Makefile commands
  - [x] Add contribution guidelines
  - [x] Include testing instructions
- [x] Unit testing for configuration and setup
  - [x] Test configuration loading and validation
  - [x] Test environment variable parsing
  - [x] Verify directory structure creation
  - [x] Test Docker build process

## Dev Notes

### Project Structure
Based on [Source: architecture/source-tree.md], the project should follow this structure:
- Main package: `genesis/` containing all application code
- Runtime data: `.genesis/` directory (git-ignored) for data, logs, and state
- Configuration: `config/` directory with settings.py using Pydantic
- Testing: `tests/` with unit/ and integration/ subdirectories
- Scripts: `scripts/` for operational scripts like backup.sh, deploy.sh
- Database migrations: `alembic/` for schema migrations

### Technology Stack
From [Source: architecture/tech-stack.md#Technology Stack Table]:
- **Python Version:** 3.11.8 (CPython) - MUST use exactly this version
- **Core Dependencies for base.txt:**
  - ccxt==4.2.25 (Exchange library)
  - rich==13.7.0 (Terminal UI)
  - textual==0.47.1 (Terminal Framework)
  - aiohttp==3.9.3 (Async HTTP client)
  - websockets==12.0 (WebSocket client)
  - pydantic==2.5.3 (Configuration validation)
  - structlog==24.1.0 (Logging)
  - alembic==1.13.1 (Database migrations)
  - pandas==2.2.0 (Data analysis)
  - numpy==1.26.3 (Numerical computing)
- **Development Tools for dev.txt:**
  - pytest==8.0.0 (Testing framework)
  - pytest-cov==4.1.0 (Coverage reporting)
  - black==24.1.1 (Code formatting)
  - ruff==0.1.14 (Linting - NOT pylint)
  - mypy==1.8.0 (Type checking)

### Configuration Management
From [Source: architecture/tech-stack.md]:
- Use pydantic==2.5.3 for configuration validation
- Parse environment variables with validation
- Never commit secrets or API keys

### Docker Configuration
From [Source: architecture/tech-stack.md]:
- Docker version 25.0.0
- Ubuntu 22.04 LTS base for consistency with DigitalOcean deployment
- Supervisor 4.2.5 for process management in production

### Coding Standards
From [Source: architecture/coding-standards.md]:
- Black formatter with line length 88
- Ruff linter (not pylint) for 10-100x faster linting
- Type hints mandatory for all functions
- Never use print() - always use structlog
- File naming: snake_case for all Python files

### Testing Requirements
From [Source: architecture/test-strategy-and-standards.md]:
- Framework: pytest 8.0.0 with pytest-asyncio
- Test file convention: `test_{module}.py`
- Unit tests location: `tests/unit/` mirroring source structure
- Coverage goals: 100% for money paths, 90% for risk/tilt, 70% for UI/analytics
- Use pytest-mock with faker for test data

### Important Notes
- The project uses ruff instead of pylint for linting (much faster)
- All async operations use asyncio (stdlib)
- SQLite for MVP phase, with Alembic migrations for future PostgreSQL transition
- Structured logging with structlog from day one
- Never use float for money calculations (use Decimal)

## Testing
- Test files should be placed in `tests/unit/` following the pattern `test_{module}.py`
- Use pytest 8.0.0 as the testing framework
- Include pytest-cov for coverage reporting
- Mock external dependencies using pytest-mock
- Aim for 100% coverage on critical configuration and setup code

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-23 | 1.0 | Initial story creation | Scrum Master Bob |

## Dev Agent Record

### Agent Model Used
claude-opus-4-1-20250805

### Debug Log References
- Successfully initialized Git repository and connected to GitHub remote
- Created Python 3.11 virtual environment
- Implemented comprehensive configuration management with Pydantic validation
- Set up Docker with both development and production configurations
- Configured pre-commit hooks with black, ruff, mypy, and security checks
- Created unit tests for configuration and project structure validation

### Completion Notes List
- All acceptance criteria have been met
- Project structure follows the architecture specifications exactly
- Configuration uses Pydantic for type safety and validation
- Docker setup includes supervisor for production process management
- Pre-commit hooks configured with ruff (not pylint) as specified
- Comprehensive unit tests created for configuration and structure
- GitHub repository successfully connected and initial commit pushed

### File List
**Created Files:**
- .gitignore
- .env.example
- .pre-commit-config.yaml
- .secrets.baseline
- README.md
- Makefile
- pyproject.toml
- requirements.txt
- requirements/base.txt
- requirements/sniper.txt
- requirements/hunter.txt
- requirements/strategist.txt
- requirements/dev.txt
- config/__init__.py
- config/settings.py
- genesis/__init__.py
- genesis/__main__.py
- genesis/core/__init__.py
- genesis/engine/__init__.py
- genesis/engine/executor/__init__.py
- genesis/tilt/__init__.py
- genesis/tilt/indicators/__init__.py
- genesis/strategies/__init__.py
- genesis/strategies/sniper/__init__.py
- genesis/strategies/hunter/__init__.py
- genesis/strategies/strategist/__init__.py
- genesis/exchange/__init__.py
- genesis/data/__init__.py
- genesis/analytics/__init__.py
- genesis/ui/__init__.py
- genesis/ui/widgets/__init__.py
- genesis/ui/themes/__init__.py
- genesis/api/__init__.py
- genesis/utils/__init__.py
- genesis/risk/__init__.py
- tests/__init__.py
- tests/conftest.py
- tests/unit/test_config.py
- tests/unit/test_project_structure.py
- docker/Dockerfile
- docker/docker-compose.yml
- docker/docker-compose.prod.yml
- docker/supervisord.conf
- scripts/backup.sh
- scripts/deploy.sh
- scripts/emergency_close.py
- alembic/alembic.ini
- alembic/env.py

## QA Results
*To be populated by QA agent*